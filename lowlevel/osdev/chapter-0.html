<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="OSDev Chapter 0 Basic Kernel" /><meta name="author" content="Zeropio" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://zeropio.ninja//lowlevel/osdev/chapter-0" /><meta property="og:url" content="https://zeropio.ninja//lowlevel/osdev/chapter-0" /><meta property="og:site_name" content="Zeropio’s Dojo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-13T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OSDev Chapter 0 Basic Kernel" /><meta name="twitter:site" content="@ZeropioWasTaken" /><meta name="twitter:creator" content="@ZeropioWasTaken" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zeropio","url":"https://twitter.com/ZeropioWasTaken"},"dateModified":"2023-05-11T13:09:50+02:00","datePublished":"2023-04-13T00:00:00+02:00","description":"Introduction","headline":"OSDev Chapter 0 Basic Kernel","mainEntityOfPage":{"@type":"WebPage","@id":"https://zeropio.ninja//lowlevel/osdev/chapter-0"},"url":"https://zeropio.ninja//lowlevel/osdev/chapter-0"}</script><title>OSDev | Chapter 0 | Basic Kernel | Zeropio's Dojo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Zeropio's Dojo"><meta name="application-name" content="Zeropio's Dojo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Zeropio's Dojo</a></div><div class="site-subtitle font-italic">Cyberninja</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/zeropio" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://ctftime.org/team/212175" aria-label="ctftime" target="_blank" rel="noopener noreferrer"> <i class="fas fa-flag"></i> </a> <a href="https://app.hackthebox.com/profile/380109" aria-label="hackthebox" target="_blank" rel="noopener noreferrer"> <i class="fas fa-cube"></i> </a> <a href="https://twitter.com/ZeropioWasTaken" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OSDev | Chapter 0 | Basic Kernel</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>OSDev | Chapter 0 | Basic Kernel</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681336800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 13, 2023 </em> </span> <span> Updated <em class="" data-ts="1683803390" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 11, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/ZeropioWasTaken">Zeropio</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1840 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This series, is a personal project focused on learning more about ASM, kernel development, computer basics, and Rust. This is not a professional blog, and I will be using resources from various sites. Some of the posts may be scripts, while others will not. I will always include a <strong>Resources</strong> section with all the sites I consulted. Please feel free to point out any errors.</p><p>Also, I’m going to assume that you already know some stuff. So, I won’t be explaining things like what a CPU is or what ASM is, or how to write in ASM from scratch.</p><p>If anyone want to replay my practices, I’m doing this on a native Arch Linux with Qemu as hypervisor. Also, I will be mainly following <a href="https://os.phil-opp.com/">Writing an OS in Rust</a> from Philipp Oppermann.</p><p>Enjoy!</p><p><br /></p><hr /><h2 id="booting"><span class="mr-2">Booting</span><a href="#booting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When a computer starts up, the first thing it does is look for an operating system. This OS is located in a section of the memory called the <strong>boot sector</strong>, which is the first sector of a bootable drive. It is recognizable as it is 512 bytes long and ends with <code class="language-plaintext highlighter-rouge">55 AA</code>.</p><p>A simple bootable can be created using the following code:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">jmp</span> <span class="kc">$</span>

<span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
<span class="kd">db</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xaa</span>
</pre></table></code></div></div><p>Let’s analyze line by line:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">times</code> repeats a number of times (<code class="language-plaintext highlighter-rouge">510-($-$$)</code>) an action (<code class="language-plaintext highlighter-rouge">db 0</code>). In this case, add the byte 0 to the code. The <code class="language-plaintext highlighter-rouge">$$</code> represent the beginning of the current section, so <code class="language-plaintext highlighter-rouge">$-$$</code> is the length of the previous code.</p><p>Then, add the last bytes to make it a bootable section:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">db</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xaa</span>
</pre></table></code></div></div><p>After creating the code, it can easily be compiled into a <em>bin</em> file and booted with QEMU:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nasm <span class="nt">-f</span> bin boot.asm <span class="nt">-o</span> boot.bin
qemu-system-x86_64 boot.bin
</pre></table></code></div></div><p><a href="/assets/img/osdev/Untitled.png" class="popup img-link "><img data-src="/assets/img/osdev/Untitled.png" alt="Untitled" class="lazyload" data-proofer-ignore></a> <em>Simple boot</em></p><p><br /></p><hr /><h2 id="strings"><span class="mr-2">Strings</span><a href="#strings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="printing"><span class="mr-2">Printing</span><a href="#printing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can use the <strong>BIOS</strong> (<strong>B</strong>asic <strong>I</strong>nput/<strong>O</strong>utput <strong>S</strong>ystem) to perform some functions, like printing characters on screen. To print a char in NASM we need to build the following:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0e</span> <span class="c1">; set ah</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span><span class="s">'Z'</span> <span class="c1">; move the character</span>
<span class="nf">int</span> <span class="mh">0x10</span> <span class="c1">; call BIOS interreput</span>
</pre></table></code></div></div><p>But sometimes, we don’t just want to print a single character but an entire string. For this, we can use the <code class="language-plaintext highlighter-rouge">db</code> instruction, that will set bytes in the memory. The string must end with a null byte (<code class="language-plaintext highlighter-rouge">0</code>):</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">org</span> <span class="mh">0x7c00</span><span class="p">]</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0e</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="p">[</span><span class="nv">string</span><span class="p">]</span>
<span class="nf">int</span> <span class="mh">0x10</span>

<span class="nf">jmp</span> <span class="kc">$</span>

<span class="nl">string:</span>
    <span class="kd">db</span> <span class="s">"Welcome to ZerOS!"</span><span class="p">,</span> <span class="mi">0</span>
</pre></table></code></div></div><p>Here, we reference the memory address of the <code class="language-plaintext highlighter-rouge">string</code> label to <code class="language-plaintext highlighter-rouge">al</code>. Memory address doesn’t start by 0 - instead they start with the offset <code class="language-plaintext highlighter-rouge">0x7c00</code>. The BIOS has its own <em>Interrupt Vector Table</em> with all the interrupt codes. They are loaded before any other program, and for safety reasons, the origin is taken at <code class="language-plaintext highlighter-rouge">0x7c00</code> to avoid collisions.</p><p>We can add it to the reference (<code class="language-plaintext highlighter-rouge">[string + 0x7c00]</code>) or set the origin at that address (<code class="language-plaintext highlighter-rouge">[org 0x7c00]</code>).</p><p>This only prints the first character. We can start a small program to print the whole string:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">org</span> <span class="mh">0x7c00</span><span class="p">]</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0e</span>
<span class="nf">mov</span> <span class="nb">bx</span><span class="p">,</span> <span class="nv">string</span>

<span class="nl">print:</span>
    <span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="p">[</span><span class="nb">bx</span><span class="p">]</span>
    <span class="nf">cmp</span> <span class="nb">al</span><span class="p">,</span> <span class="mi">0</span>
    <span class="nf">je</span> <span class="nv">end</span>
    <span class="nf">int</span> <span class="mh">0x10</span>
    <span class="nf">inc</span> <span class="nb">bx</span>
    <span class="nf">jmp</span> <span class="nv">print</span>
<span class="nl">end:</span>

<span class="nf">jmp</span> <span class="kc">$</span>

<span class="nl">string:</span>
    <span class="kd">db</span> <span class="s">"Welcome to ZerOS!"</span><span class="p">,</span> <span class="mi">0</span>

<span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
<span class="kd">db</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xaa</span>
</pre></table></code></div></div><p>Now we can print anything!</p><p><a href="/assets/img/osdev/Untitled%201.png" class="popup img-link "><img data-src="/assets/img/osdev/Untitled%201.png" alt="Untitled" class="lazyload" data-proofer-ignore></a> <em>String Print</em></p><h3 id="input"><span class="mr-2">Input</span><a href="#input" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now we need to input some data, instead of just printing. We have the BIOS interreput <code class="language-plaintext highlighter-rouge">0x16</code> with <code class="language-plaintext highlighter-rouge">ah = 0</code>. Here, we have implemented a buffer that allocates a string of 10 bytes:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nl">buffer:</span>
    <span class="kd">times</span> <span class="mi">10</span> <span class="nv">db</span> <span class="mi">0</span>
    <span class="nf">mov</span> <span class="nb">bx</span><span class="p">,</span> <span class="nv">buffer</span>
    <span class="nf">mov</span> <span class="p">[</span><span class="nb">bx</span><span class="p">],</span> <span class="nb">al</span>
    <span class="nf">inc</span> <span class="nb">bx</span>
    <span class="nf">cmp</span> <span class="nb">bx</span><span class="p">,</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mi">0</span>
<span class="nf">int</span> <span class="mh">0x16</span>

<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="p">[</span><span class="nb">ch</span><span class="nv">ar</span><span class="p">]</span>
</pre></table></code></div></div><p><br /></p><hr /><h2 id="reading-disk"><span class="mr-2">Reading Disk</span><a href="#reading-disk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All BIOS count with functions to read from it. HHD disk has <strong>C</strong>ylinders where the data is stored, and two <strong>H</strong>ead for each - one for read and one for write. Also, each platter is divided into <strong>S</strong>ectors, with each sector being divided into 512 bytes (like the boot sector).</p><p><a href="/assets/img/osdev/Section-1.png" class="popup img-link "><img data-src="/assets/img/osdev/Section-1.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>When the BIOS read the disk, it needs to know <strong>CHS</strong>. We can modify the code to add a full section:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">org</span> <span class="nv">ox7c00</span><span class="p">]</span>
<span class="nf">jmp</span> <span class="kc">$</span>
<span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
<span class="kd">db</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xaa</span>
<span class="kd">times</span> <span class="mi">512</span> <span class="nv">db</span> <span class="s">'A'</span>
</pre></table></code></div></div><p>The call <code class="language-plaintext highlighter-rouge">int 0x13</code> for read the disk need the following:</p><ul><li>What disk to read<li>CHS address (<strong>C</strong> and <strong>H</strong> start by 0, while <strong>S</strong> start by 1)<li>How many sectors?<li>Where do we load them?</ul><p>We can use the following code:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mi">2</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="mi">1</span>   <span class="c1">; number of sectors</span>
<span class="nf">mov</span> <span class="nb">ch</span><span class="p">,</span> <span class="mi">0</span>   <span class="c1">; cylinder number</span>
<span class="nf">mov</span> <span class="nb">cl</span><span class="p">,</span> <span class="mi">2</span>   <span class="c1">; sector number</span>
<span class="nf">mov</span> <span class="nb">dh</span><span class="p">,</span> <span class="mi">0</span>   <span class="c1">; head number</span>
<span class="nf">mov</span> <span class="nb">dl</span><span class="p">,</span> <span class="p">[</span><span class="nb">di</span><span class="nv">sk</span><span class="p">]</span>    <span class="c1">; driver number, saved in a variable</span>
<span class="nf">int</span> <span class="mh">0x13</span>
</pre></table></code></div></div><p>Now, we can print a value from the disk:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0e</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,[</span><span class="mh">0x7e00</span><span class="p">]</span>
<span class="nf">int</span> <span class="mh">0x10</span>
</pre></table></code></div></div><p>To create the disk, just:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">mov</span> <span class="p">[</span><span class="nb">di</span><span class="nv">sk</span><span class="p">],</span> <span class="nb">dl</span>
<span class="nf">...</span>
<span class="nl">disk:</span> <span class="kd">db</span> <span class="mi">0</span>
</pre></table></code></div></div><p>And set up the stack:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">xor</span> <span class="nb">ax</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">es</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">ds</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">bp</span><span class="p">,</span> <span class="mh">0x8000</span>
<span class="nf">mov</span> <span class="nb">sp</span><span class="p">,</span> <span class="nb">bp</span>

<span class="nf">mov</span> <span class="nb">bx</span><span class="p">,</span> <span class="mh">0x7e00</span>
</pre></table></code></div></div><p>The final code will be:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">org</span> <span class="mh">0x7c00</span><span class="p">]</span>
<span class="nf">mov</span> <span class="p">[</span><span class="nb">di</span><span class="nv">sk</span><span class="p">],</span> <span class="nb">dl</span>

<span class="c1">; setting up the stack</span>
<span class="nf">xor</span> <span class="nb">ax</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">es</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">ds</span><span class="p">,</span> <span class="nb">ax</span>
<span class="nf">mov</span> <span class="nb">bp</span><span class="p">,</span> <span class="mh">0x8000</span>
<span class="nf">mov</span> <span class="nb">sp</span><span class="p">,</span> <span class="nb">bp</span>

<span class="nf">mov</span> <span class="nb">bx</span><span class="p">,</span> <span class="mh">0x7e00</span>

<span class="c1">; reading the disk</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mi">2</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="mi">1</span>
<span class="nf">mov</span> <span class="nb">ch</span><span class="p">,</span> <span class="mi">0</span>
<span class="nf">mov</span> <span class="nb">dh</span><span class="p">,</span> <span class="mi">0</span>
<span class="nf">mov</span> <span class="nb">cl</span><span class="p">,</span> <span class="mi">2</span>
<span class="nf">mov</span> <span class="nb">dl</span><span class="p">,</span> <span class="p">[</span><span class="nb">di</span><span class="nv">sk</span><span class="p">]</span>
<span class="nf">int</span> <span class="mh">0x13</span>

<span class="c1">; printing the first sector</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0e</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="p">[</span><span class="mh">0x7e00</span><span class="p">]</span>
<span class="nf">int</span> <span class="mh">0x10</span>
<span class="nf">jmp</span> <span class="kc">$</span>
<span class="nl">disk:</span> <span class="kd">db</span> <span class="mi">0</span>

<span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
<span class="kd">dw</span> <span class="mh">0xaa55</span>

<span class="kd">times</span> <span class="mi">512</span> <span class="nv">db</span> <span class="s">'A'</span>
</pre></table></code></div></div><p><br /></p><hr /><h2 id="protected-mode"><span class="mr-2">Protected Mode</span><a href="#protected-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Protected Mode</strong> is a 32 bits operational mode. First, we need to start segmentation in <strong>PM</strong>. For this we will not use registers, but the <strong>GDT</strong> (<strong>G</strong>lobal <strong>D</strong>escriptor <strong>T</strong>able).</p><h3 id="descriptors"><span class="mr-2">Descriptors</span><a href="#descriptors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We need to find a <strong>Descriptors</strong> (a list of properties of a segment) for each segment we are going to use in PM. There are several memory models and technique, as:</p><ul><li>Flat memory model: use memory address as a single continous space<li>Segmentarion<li>Paging</ul><p>GDT must contain a <strong>code segment Descriptor</strong> and <strong>data segment Descriptor</strong>.</p><h4 id="code-segment-descriptor"><span class="mr-2">Code Segment Descriptor</span><a href="#code-segment-descriptor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, we need to define the size of the segment and the location. The <strong>base</strong> property of the segment describes the starting location, and <strong>limit</strong> describes the size.</p><p>Then we have:</p><ul><li><strong>Present</strong> - single bit, set to <code class="language-plaintext highlighter-rouge">1</code> if the segment is used<li><strong>Privilege</strong> - two bit value from zero to three, used to define <em>segment hierarchy</em> and <em>memory protection</em>, the highest privilege is <code class="language-plaintext highlighter-rouge">00</code> (<em>ring</em>)<li><strong>Type</strong> - single bit, set to <code class="language-plaintext highlighter-rouge">1</code> if it is code segment</ul><p>The others propertiers are <strong>flags</strong>. We have <strong>Type flags</strong> (4 bits):</p><ul><li>Code - if it is code it’s value is <code class="language-plaintext highlighter-rouge">1</code><li>Conforming - if the code can be executed from lower privileged segments (<code class="language-plaintext highlighter-rouge">0</code> for no)<li>Readable - if it is readable the value is <code class="language-plaintext highlighter-rouge">1</code><li>Accessed - managed by CPU, set to <code class="language-plaintext highlighter-rouge">0</code> to let the CPU work</ul><p>The <strong>Other flags</strong> (4 bits):</p><ul><li>Granualarity - when it is <code class="language-plaintext highlighter-rouge">1</code> the limit is multiply by <code class="language-plaintext highlighter-rouge">0x1000</code>, so we can span 4GB of memory<li>32 bits - <code class="language-plaintext highlighter-rouge">1</code> for years<li>the other two must be set to <code class="language-plaintext highlighter-rouge">0</code></ul><p>So the end view will be:</p><div class="table-wrapper"><table><thead><tr><th>pres,priv,type<th>1001<tbody><tr><td>Type flags<td>1010<tr><td>Other flags<td>1100</table></div><h4 id="data-segment-descriptor"><span class="mr-2">Data Segment Descriptor</span><a href="#data-segment-descriptor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We should change the following:</p><ul><li>No code flag<li>Conforming get repace by direction, if it is <code class="language-plaintext highlighter-rouge">1</code> the segment become a <em>expand down segment</em> (grows downwards)<li>Readable change to writeable</ul><p>So the end view will be:</p><div class="table-wrapper"><table><thead><tr><th>pres,priv,type<th>1001<tbody><tr><td>Type flags<td>0010<tr><td>Other flags<td>1100</table></div><h3 id="define-gdt-in-asm"><span class="mr-2">Define GDT in ASM</span><a href="#define-gdt-in-asm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We need to define:</p><ul><li><code class="language-plaintext highlighter-rouge">db</code> - define bytes<li><code class="language-plaintext highlighter-rouge">dw</code> - defines words<li><code class="language-plaintext highlighter-rouge">dd</code> - defines double words</ul><p>First we need to define a <strong>null</strong> descriptor, then the <strong>code</strong> and the <strong>data</strong> descriptors, ended by <code class="language-plaintext highlighter-rouge">GDT_end</code>:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nl">GDT_Start:</span>
    <span class="nl">GDT_null:</span>
        <span class="kd">dd</span> <span class="mh">0x0</span>
        <span class="kd">dd</span> <span class="mh">0x0</span>

    <span class="nl">GDT_code:</span>
        <span class="kd">dw</span> <span class="mh">0xffff</span>        <span class="c1">; define 16 firsts bits of the limit</span>
        <span class="kd">dw</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mh">0x0</span>           <span class="c1">; define 24 first bits of the base</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">10011010</span>    <span class="c1">; define present, privilege and type properties and type flags</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">11001111</span>    <span class="c1">; define other flags and last four bits of the limit</span>
        <span class="kd">db</span> <span class="mh">0x0</span>           <span class="c1">; last 8 bits</span>

    <span class="nl">GDT_data:</span>
        <span class="kd">dw</span> <span class="mh">0xffff</span>
        <span class="kd">dw</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">10010010</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">11001111</span>
        <span class="kd">db</span> <span class="mh">0x0</span>
</pre></table></code></div></div><p>Now we need to describe a <code class="language-plaintext highlighter-rouge">GDT_Descriptor</code>:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nl">GDT_descriptor:</span>
    <span class="kd">dw</span> <span class="nv">GDT_end</span> <span class="o">-</span> <span class="nv">GDT_start</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1">; size</span>
    <span class="kd">dd</span> <span class="nv">GDT_start</span>               <span class="c1">; start</span>
</pre></table></code></div></div><p>To use that values we need to declare them previously:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="no">CODE_SEG</span><span class="kd"> equ</span> <span class="nv">GDT_code</span> <span class="o">-</span> <span class="nv">GDT_start</span>
<span class="no">DATA_SEG</span><span class="kd"> equ</span> <span class="nv">GDT_data</span> <span class="o">-</span> <span class="nv">GDT_start</span>
</pre></table></code></div></div><p>Now we can switch to <strong>Protected Mode</strong>. First, disable all interrupts using <code class="language-plaintext highlighter-rouge">cli</code>. Then load GDT using the <code class="language-plaintext highlighter-rouge">lgdt</code>. Then, we need to change the last bit of a special 32-bit register called <code class="language-plaintext highlighter-rouge">cr0</code> to <code class="language-plaintext highlighter-rouge">1</code>. Since we cannot change it directly, we need to use a 32 bit register for it.</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">cli</span>
<span class="nf">lgdt</span> <span class="p">[</span><span class="nv">GDT_Descriptor</span><span class="p">]</span>

<span class="c1">; change last bif of cr0 to 1</span>
<span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">cr0</span>
<span class="nf">or</span> <span class="nb">eax</span><span class="p">,</span><span class="mi">1</span>
<span class="nf">mov</span> <span class="nb">cr0</span><span class="p">,</span><span class="nb">eax</span>
</pre></table></code></div></div><p>Now, the CPU is in PM 32-bits. Now we need to do a <strong>far jump</strong> to another segment or label. For example:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">bits</span> <span class="mi">32</span><span class="p">]</span>
<span class="nl">start_protected_mode:</span>
</pre></table></code></div></div><p>We must define the bits (<code class="language-plaintext highlighter-rouge">[bits 32]</code>). Now we can’t use BIOS, now we need to write to <strong>Video Memory</strong> directly, which in text mode starts by <code class="language-plaintext highlighter-rouge">0xb8000</code>. The first byte will be the character, while the second the colour:</p><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">bits</span> <span class="mi">32</span><span class="p">]</span>
<span class="nl">start_protected_mode:</span>
<span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span><span class="s">'A'</span>
<span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span><span class="mh">0x0f</span> <span class="c1">; white on black</span>
<span class="nf">mov</span> <span class="p">[</span><span class="mh">0xb8000</span><span class="p">],</span> <span class="nb">ax</span>
</pre></table></code></div></div><p><br /></p><hr /><h2 id="final-code"><span class="mr-2">Final Code</span><a href="#final-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-nasm highlighter-rouge"><div class="code-header"> <span data-label-text="Nasm"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="err">[</span><span class="nf">org</span> <span class="mh">0x7c00</span><span class="p">]</span>

<span class="no">CODE_SEG</span><span class="kd"> equ</span> <span class="nv">GDT_code</span> <span class="o">-</span> <span class="nv">GDT_start</span>
<span class="no">DATA_SEG</span><span class="kd"> equ</span> <span class="nv">GDT_data</span> <span class="o">-</span> <span class="nv">GDT_start</span>

<span class="nf">cli</span>
<span class="nf">lgdt</span> <span class="p">[</span><span class="nv">GDT_descriptor</span><span class="p">]</span>
<span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">cr0</span>
<span class="nf">or</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="nf">mov</span> <span class="nb">cr0</span><span class="p">,</span> <span class="nb">eax</span>
<span class="nf">jmp</span> <span class="nv">CODE_SEG</span><span class="p">:</span><span class="nv">start_protected_mode</span>

<span class="nf">jmp</span> <span class="kc">$</span>

<span class="nl">GDT_start:</span>
    <span class="nl">GDT_null:</span>
        <span class="kd">dd</span> <span class="mh">0x0</span>
        <span class="kd">dd</span> <span class="mh">0x0</span>

    <span class="nl">GDT_code:</span>
        <span class="kd">dw</span> <span class="mh">0xffff</span>
        <span class="kd">dw</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">10011010</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">11001111</span>
        <span class="kd">db</span> <span class="mh">0x0</span>

    <span class="nl">GDT_data:</span>
        <span class="kd">dw</span> <span class="mh">0xffff</span>
        <span class="kd">dw</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mh">0x0</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">10010010</span>
        <span class="kd">db</span> <span class="mb">0b</span><span class="mi">11001111</span>
        <span class="kd">db</span> <span class="mh">0x0</span>

<span class="nl">GDT_end:</span>

<span class="nl">GDT_descriptor:</span>
    <span class="kd">dw</span> <span class="nv">GDT_end</span> <span class="o">-</span> <span class="nv">GDT_start</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="kd">dd</span> <span class="nv">GDT_start</span>

<span class="err">[</span><span class="nf">bits</span> <span class="mi">32</span><span class="p">]</span>
<span class="nl">start_protected_mode:</span>
    <span class="nf">mov</span> <span class="nb">al</span><span class="p">,</span> <span class="s">'A'</span>
    <span class="nf">mov</span> <span class="nb">ah</span><span class="p">,</span> <span class="mh">0x0f</span>
    <span class="nf">mov</span> <span class="p">[</span><span class="mh">0xb8000</span><span class="p">],</span> <span class="nb">ax</span>
    <span class="nf">jmp</span> <span class="kc">$</span>

<span class="kd">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="kc">$</span><span class="o">-</span><span class="kc">$$</span><span class="p">)</span> <span class="nv">db</span> <span class="mi">0</span>
<span class="kd">dw</span> <span class="mh">0xaa55</span>
</pre></table></code></div></div><p>And now, we can write anything:</p><p><a href="/assets/img/osdev/Untitled%203.png" class="popup img-link "><img data-src="/assets/img/osdev/Untitled%203.png" alt="Untitled" class="lazyload" data-proofer-ignore></a> <em>Final Version</em></p><p><br /></p><hr /><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://www.youtube.com/playlist?list=PLm3B56ql_akNcvH8vvJRYOc7TbYhRs19M">Making an OS (x86)</a><li><a href="https://wiki.osdev.org/Main_Page">Wiki OSDev</a><li><a href="http://www.osdever.net/">OS Dever</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/lowlevel/'>LowLevel</a>, <a href='/categories/osdev/'>OSDev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/lowlevel/" class="post-tag no-text-decoration" >lowlevel</a> <a href="/tags/osdev/" class="post-tag no-text-decoration" >osdev</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OSDev%20%7C%20Chapter%200%20%7C%20Basic%20Kernel%20-%20Zeropio's%20Dojo&url=https%3A%2F%2Fzeropio.ninja%2F%2Flowlevel%2Fosdev%2Fchapter-0" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OSDev%20%7C%20Chapter%200%20%7C%20Basic%20Kernel%20-%20Zeropio's%20Dojo&u=https%3A%2F%2Fzeropio.ninja%2F%2Flowlevel%2Fosdev%2Fchapter-0" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fzeropio.ninja%2F%2Flowlevel%2Fosdev%2Fchapter-0&text=OSDev%20%7C%20Chapter%200%20%7C%20Basic%20Kernel%20-%20Zeropio's%20Dojo" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/index">Index</a><li><a href="/sensei/shellcode-blacksmith">The Shellcode Blacksmith | Sensei</a><li><a href="/lowlevel/osdev/chapter-0">OSDev | Chapter 0 | Basic Kernel</a><li><a href="/malware/development/putty-1">MalDev | Putty</a><li><a href="/malware/development/dropper-explorer-1">MalDev | Dropper Explorer.exe</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/lowlevel/">lowlevel</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/osdev/">osdev</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/reversing/">reversing</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/lowlevel/osdev/chapter-1"><div class="card-body"> <em class="small" data-ts="1681596000" data-df="ll" > Apr 16, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSDev | Chapter 1 | Freestanding Rust</h3><div class="text-muted small"><p> Introduction The kernel will be written in Rust, which is why we need to do some preparations before starting to code. This will not be the beginning of development, but rather the setup phase. Th...</p></div></div></a></div><div class="card"> <a href="/lowlevel/osdev/chapter-2"><div class="card-body"> <em class="small" data-ts="1681682400" data-df="ll" > Apr 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSDev | Chapter 2 | Rust Kernel</h3><div class="text-muted small"><p> Introduction Now that we have a freestanding Rust binary, the next step is to create the kernel. We will create a 64-bit kernel for the x86 architecture. As we saw in the first chapter, we will be...</p></div></div></a></div><div class="card"> <a href="/lowlevel/osdev/chapter-3"><div class="card-body"> <em class="small" data-ts="1682460000" data-df="ll" > Apr 26, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSDev | Chapter 3 | Interrupts</h3><div class="text-muted small"><p> Introduction To create a functional OS, it is essential to handle errors such as division by zero, attempts to access non-existent memory addresses, and other potential issues. One approach to han...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/malware/development/dropper-explorer-1" class="btn btn-outline-primary" prompt="Older"><p>MalDev | Dropper Explorer.exe</p></a> <a href="/lowlevel/osdev/chapter-1" class="btn btn-outline-primary" prompt="Newer"><p>OSDev | Chapter 1 | Freestanding Rust</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/lowlevel/">lowlevel</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/osdev/">osdev</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/reversing/">reversing</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ZeropioWasTaken">zeropio</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
